<div class="card {{ '' if image.enabled else 'is-disabled' }}" id="img-{{ image.id }}">
  <img src="/static/thumbs/{{ image.filename }}" alt="" style="width:100%;border-radius:8px">
  <div class="image-info">
    <div class="title-display" id="title-display-{{ image.id }}">{{ image.title or image.original_name }}</div>
    <div class="title-edit" id="title-edit-{{ image.id }}" style="display: none;">
      <input type="text" id="title-input-{{ image.id }}" value="{{ image.title or image.original_name }}" placeholder="Image title">
      <textarea id="desc-input-{{ image.id }}" placeholder="Description">{{ image.description }}</textarea>
      
      <!-- Crop controls -->
      <div class="crop-controls">
        <h4>Crop Settings</h4>
        <div class="crop-preview">
          <img src="/static/uploads/{{ image.filename }}" id="crop-preview-{{ image.id }}" style="max-width: 200px; max-height: 150px;">
          <div class="crop-overlay" id="crop-overlay-{{ image.id }}"></div>
        </div>
        <div class="crop-inputs">
          <label>X: <input type="range" id="crop-x-{{ image.id }}" min="0" max="100" value="{{ image.crop_x or 0 }}">
            <span id="crop-x-val-{{ image.id }}">{{ image.crop_x or 0 }}%</span></label>
          <label>Y: <input type="range" id="crop-y-{{ image.id }}" min="0" max="100" value="{{ image.crop_y or 0 }}">
            <span id="crop-y-val-{{ image.id }}">{{ image.crop_y or 0 }}%</span></label>
          <label>Width: <input type="range" id="crop-width-{{ image.id }}" min="10" max="100" value="{{ image.crop_width or 100 }}">
            <span id="crop-width-val-{{ image.id }}">{{ image.crop_width or 100 }}%</span></label>
          <label>Height: <input type="range" id="crop-height-{{ image.id }}" min="10" max="100" value="{{ image.crop_height or 100 }}">
            <span id="crop-height-val-{{ image.id }}">{{ image.crop_height or 100 }}%</span></label>
        </div>
      </div>
      
      <div class="edit-buttons">
        <button class="save-edit" data-id="{{ image.id }}">Save</button>
        <button class="cancel-edit" data-id="{{ image.id }}">Cancel</button>
      </div>
    </div>
    {% if image.description %}
      <div class="description" id="desc-display-{{ image.id }}">{{ image.description }}</div>
    {% endif %}
  </div>
  <div class="row" style="justify-content:space-between;margin-top:.5rem">
    <small>Shown {{ image.times_shown }} times</small>
  </div>
  <div class="row" style="margin-top:.5rem">
    <button
      class="toggle-enabled"
      data-id="{{ image.id }}"
      aria-pressed="{{ 'true' if image.enabled else 'false' }}">
      {{ 'Disable' if image.enabled else 'Enable' }}
    </button>
    <button class="edit-image" data-id="{{ image.id }}">Edit</button>
    <button class="show-now" data-id="{{ image.id }}">Show now</button>
    <form method="post" action="/image/{{image.id}}/delete" onsubmit="return confirm('Delete image?')"><button>Delete</button></form>
  </div>
</div>
